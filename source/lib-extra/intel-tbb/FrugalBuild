# Compiling Time: 0.1 SBU
# Maintainer: Marius Cirsta <mcirsta@frugalware.org>

pkgname=intel-tbb
pkgver=40_20120201
pkgrel=1
pkgdesc='An award-winning C++ runtime library that abstracts the low-level threading details necessary for optimal multi-core performance.'
depends=('glibc>=2.14')
archs=('i686' 'x86_64')
url='http://www.threadingbuildingblocks.org/'
groups=('lib-extra')
_F_cd_path="tbb${pkgver}oss"
pkgsubver=`lynx -dump http://threadingbuildingblocks.org/file.php?fid=77 | grep -m1 ' update ' | sed 's/.*update \([0-9]*\)/\1/'`
verId=`lynx -dump http://threadingbuildingblocks.org/file.php?fid=77 | grep -m 1 'http://threadingbuildingblocks.org/ver.php?fid=' | \
       sed 's/.*http:\/\/threadingbuildingblocks.org\/ver.php?fid=\([0-9]*\)/\1/'`
source=("http://threadingbuildingblocks.org/uploads/77/${verId}/4.0%20update%20${pkgsubver}/tbb${pkgver}oss_src.tgz")
up2date="lynx -dump http://threadingbuildingblocks.org/file.php?fid=77 | grep -m 1 'tbb' | sed 's/.*tbb\([^o]*\).*/\1/'"
sha1sums=('717879cd6ce05161892bb44be5a375ed1ed9f7d6')

build()
{
	Fmake
	Fmkdir usr/lib
	releaseDir=build/`ls build | grep "release"`/
	for libFile in `ls $releaseDir | grep ".*\.so.*"`
	do
		echo $releaseDir$libFile
		Fexerel $releaseDir$libFile usr/lib
	done
	Fmkdir usr/include
	Fcprel include/tbb usr/include
}
